# ExamPilot 使用指南

## 目录

1. [快速开始](#快速开始)
2. [基本配置](#基本配置)
3. [答题流程](#答题流程)
4. [高级功能](#高级功能)
5. [常见问题](#常见问题)

## 快速开始

### 第一次使用

1. **启动系统**
   ```bash
   ./start.sh
   ```

2. **访问Web界面**
   - 打开浏览器访问：http://localhost:8000

3. **配置LLM（必须）**
   - 点击顶部导航栏的"LLM设置"
   - 点击"添加配置"
   - 填写以下信息：
     - 配置名称：例如 "DeepSeek主配置"
     - 供应商：DeepSeek
     - API密钥：你的API密钥
     - API地址：https://api.deepseek.com/v1
     - 模型名称：deepseek-chat
     - 配置类型：LLM
     - 状态：启用
   - 点击"保存"

4. **开始第一次答题**
   - 返回首页
   - 输入问卷星链接
   - 点击"解析问卷"
   - 选择"全自动AI答题"模式
   - 点击"开始答题"

## 基本配置

### LLM配置

系统支持三种LLM配置类型：

#### 1. LLM配置（必需）
用于智能答题的主要模型

**推荐配置：**
- DeepSeek: https://api.deepseek.com/v1, deepseek-chat
- OpenAI: https://api.openai.com/v1, gpt-4
- 其他OpenAI兼容API

#### 2. Embedding配置（可选）
用于知识库向量化

**推荐配置：**
- DeepSeek: https://api.deepseek.com/v1, deepseek-embedding
- OpenAI: https://api.openai.com/v1, text-embedding-3-small

#### 3. Rerank配置（可选）
用于知识库结果重排序

**说明：**
- 如果API不支持rerank，系统会自动跳过
- 不影响基本功能

### 系统设置

在"系统设置"页面可以调整以下参数：

#### 答题设置
- **置信度阈值**（0.0-1.0）
  - 默认：0.7
  - 说明：低于此值的答案会被标记为低置信度
  - 建议：重要考试设为0.8，一般问卷设为0.6

- **使用知识库**（开/关）
  - 默认：开
  - 说明：是否在答题时检索知识库

#### 时间模拟设置
- **时间策略**
  - 均匀分布：每题时间随机，分布均匀
  - 正态分布：大部分题目集中在平均时间附近
  - 分段停顿：模拟思考停顿，更自然

- **最小答题时间**（秒）
  - 默认：2.0
  - 说明：每题最少花费的时间

- **最大答题时间**（秒）
  - 默认：10.0
  - 说明：每题最多花费的时间

## 答题流程

### 模式一：全自动AI答题

**适用场景：**
- 完全信任AI的能力
- 题目比较标准
- 追求效率

**操作步骤：**
1. 解析问卷后，选择"全自动AI答题"
2. 点击"开始答题"
3. 等待AI完成所有题目
4. 检查答案（特别是低置信度的）
5. 点击"提交答案"

**注意事项：**
- 系统会标记低置信度的答案
- 可以在答题完成后手动修改答案
- 提交前务必检查关键题目

### 模式二：用户勾选AI介入

**适用场景：**
- 部分题目需要AI辅助
- 有些题目你已知答案
- 需要更精细的控制

**操作步骤：**
1. 解析问卷后，选择"用户勾选AI介入"
2. 在题目列表中勾选需要AI回答的题目
3. 点击"开始答题"
4. AI只回答选中的题目
5. 未选中的题目可以手动填写
6. 点击"提交答案"

**技巧：**
- 简单题目不勾选，自己快速填写
- 复杂或不确定的题目勾选
- 可以先全选，再取消不需要的

### 模式三：预设答案自动填充

**适用场景：**
- 已有完整答案列表
- 重复性问卷
- 批量处理

**操作步骤：**
1. 准备答案列表（按题目顺序）
2. 解析问卷后，选择"预设答案自动填充"
3. 输入或粘贴答案（每行一个答案）
4. 点击"开始答题"
5. 系统自动填充
6. 点击"提交答案"

**答案格式：**
- 单选题：选项索引（0, 1, 2...）或选项文本
- 多选题：索引数组 [0, 2, 3] 或文本数组
- 判断题：true/false 或 0/1
- 填空题：直接输入文本

## 高级功能

### 知识库管理

**使用场景：**
- 有参考资料（教材、笔记、文档）
- 专业领域问题
- 需要引用具体内容

**使用步骤：**

1. **上传文档**
   - 进入"知识库"页面
   - 点击"上传文档"
   - 选择.txt或.md文件
   - 系统自动分块和向量化

2. **添加文本**
   - 点击"添加文本"
   - 输入标题和内容
   - 保存

3. **答题时自动检索**
   - 系统会自动搜索相关内容
   - 并提供给LLM作为参考
   - 答案中会显示引用的知识库内容

**优化建议：**
- 文档内容要准确、结构化
- 避免过长的单个文档（建议<10000字）
- 定期清理不相关的文档

### 置信度管理

**置信度含义：**
- 1.0：非常确定
- 0.7-0.9：比较确定（推荐阈值）
- 0.5-0.7：一般确定
- <0.5：不确定（需要人工审核）

**处理低置信度答案：**
1. 在答题进度页面，查看置信度标签
2. 黄色/红色标签表示低置信度
3. 点击查看推理过程
4. 决定是否修改答案

### 时间模拟策略

**选择建议：**

- **均匀分布**
  - 最简单
  - 适合：一般问卷、模拟数据

- **正态分布**（推荐）
  - 最自然
  - 适合：大部分场景

- **分段停顿**
  - 最接近真人
  - 适合：严格的反作弊检测

**参数调整：**
- 快速模式：min=1, max=3
- 正常模式：min=2, max=10（推荐）
- 谨慎模式：min=5, max=20

## 常见问题

### Q1：解析问卷失败？

**可能原因：**
1. URL格式错误
2. 问卷不是公开链接
3. 网络连接问题

**解决方案：**
- 检查URL是否正确
- 确认问卷是公开状态
- 检查网络连接
- 查看日志文件：data/logs/

### Q2：AI回答质量不好？

**改进方法：**
1. 更换更强的模型（如deepseek-chat -> gpt-4）
2. 上传相关知识库文档
3. 降低temperature参数（0.3-0.5）
4. 使用"用户勾选"模式，只让AI回答确定的题目

### Q3：提交答案失败？

**检查项目：**
1. 所有必答题是否都已回答
2. 答案格式是否正确
3. 网络是否稳定
4. 问卷是否已关闭

**解决：**
- 查看错误提示
- 手动检查答案
- 重试提交
- 如果持续失败，手动复制答案提交

### Q4：WebSocket断开连接？

**原因：**
- 网络不稳定
- 服务器重启
- 防火墙阻止

**解决：**
- 系统会自动重连（最多5次）
- 刷新页面重新开始
- 检查防火墙设置

### Q5：知识库搜索不准确？

**优化：**
1. 调整top_k参数（默认5，可以增加到10）
2. 调整score_threshold（默认0.0，可以增加到0.3）
3. 启用rerank功能
4. 优化文档质量和结构

### Q6：系统运行缓慢？

**可能原因：**
- 知识库文档过多
- 网络延迟
- API响应慢

**优化：**
- 清理不必要的知识库文档
- 使用更快的API供应商
- 减少并发请求

## 最佳实践

### 1. 配置建议

```
LLM配置：
- 主力模型：deepseek-chat (性价比高)
- 备用模型：gpt-3.5-turbo (速度快)
- 高质量：gpt-4 (质量最好)

系统设置：
- 置信度阈值：0.7
- 时间策略：正态分布
- 时间范围：2-10秒
```

### 2. 使用流程

```
1. 首次使用：配置LLM -> 测试简单问卷
2. 日常使用：上传知识库 -> 全自动答题
3. 重要考试：降低置信度阈值 -> 用户勾选模式
4. 批量处理：准备答案 -> 预设答案模式
```

### 3. 安全建议

```
- 不要在公共网络使用
- 保管好API密钥
- 定期备份数据库
- 遵守平台使用规范
```

### 4. 成本控制

```
- 使用DeepSeek等性价比高的服务
- 避免无意义的重复请求
- 关闭不必要的知识库检索
- 监控API使用量
```

## 技术支持

如遇问题，请：

1. 查看本使用指南
2. 查看日志文件：data/logs/exampilot_YYYY-MM-DD.log
3. 查看项目README.md
4. 提交Issue到GitHub

---

祝您使用愉快！🎉

